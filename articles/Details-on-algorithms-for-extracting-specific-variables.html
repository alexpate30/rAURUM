<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Details-on-algorithms-for-extracting-specific-variables â€¢ rAURUM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Details-on-algorithms-for-extracting-specific-variables">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">rAURUM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/rAURUM.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/Details-on-algorithms-for-extracting-specific-variables.html">Details-on-algorithms-for-extracting-specific-variables</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Details-on-algorithms-for-extracting-specific-variables</h1>
            
      

      <div class="d-none name"><code>Details-on-algorithms-for-extracting-specific-variables.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://alexpate30.github.io/rAURUM/">rAURUM</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: data.table</span></span></code></pre></div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p><strong>rAURUM</strong> contains a number of functions which extract
specific variables, namely:</p>
<ul>
<li>BMI: <code>extract_BMI</code>
</li>
<li>Cholesterol/high-density lipoprotein (HDL) ratio:
<code>extract_cholhdl_ratio</code>
</li>
<li>Diabetes status: <code>extract_diabetes</code>
</li>
<li>Smoking status: <code>extract_smoking</code>
</li>
</ul>
<p>The algorithms underpinning the extraction of these variables are
given here.</p>
</div>
<div class="section level2">
<h2 id="bmi-extract_bmi">BMI (<code>extract_BMI</code>)<a class="anchor" aria-label="anchor" href="#bmi-extract_bmi"></a>
</h2>
<p>Extraction of BMI requires the user to specify three codelists. One
for BMI scores (<code>codelist.BMI</code>), one for height measurements
(<code>codelist.height</code>) and one for weight measurements
(<code>codelist.weight</code>). All the BMI, height and weight
measurements for each patient in the cohort of interest are then
extracted. The algorithm is as follows:</p>
<ul>
<li>Extract the most recent BMI, height and weight measurements (within
the specified time period) according to the user inputted code lists.
Observation dates identified using variable <em>obsdate</em>.
<ul>
<li>The measurements must be non-missing</li>
<li>The BMI measurements must be within the user-defined valid
range.</li>
</ul>
</li>
<li>Rescale height scores to metres. When numunitid is not $ $, which
correspond to metres, the height measurement is divided by 100. All
other measurements are assumed to be in centimetres. .</li>
<li>All weight measurements are assumed to be in kilograms.</li>
<li>Merge height and weight measurements.
<ul>
<li>Calculate BMI for every pair of height and weight measurements using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>w</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><mi>t</mi></mrow><mrow><mi>h</mi><mi>e</mi><mi>i</mi><mi>g</mi><mi>h</mi><msup><mi>t</mi><mn>2</mn></msup></mrow></mfrac><annotation encoding="application/x-tex">\frac{weight}{height^{2}}</annotation></semantics></math>.</li>
<li>Remove BMI scores that are outside the specified range.</li>
<li>Assign observation date to be the height or weight measurement which
occurred first.</li>
</ul>
</li>
<li>Merge the directly recorded BMI scores, with the BMI scores
calculated from height and weight.</li>
<li>Take the most recent BMI score within the specified time period,
whether it was a directly recorded BMI score, or calculated from height
and weight. If both are recorded on the same date, the directly recorded
BMI score takes preference.</li>
</ul>
</div>
<div class="section level2">
<h2 id="cholesterolhdl-ratio-extract_cholhdl_ratio">Cholesterol/HDL ratio (<code>extract_cholhdl_ratio</code>)<a class="anchor" aria-label="anchor" href="#cholesterolhdl-ratio-extract_cholhdl_ratio"></a>
</h2>
<p>Extraction of cholesterol/HDL ratio requires the user to specify
three codelists. One for cholesterol/HDL ratio measurements
(<code>codelist.ratio</code>), one for total cholesterol measurements
(<code>codelist.chol</code>) and one for HDL measurements
(<code>codelist.hdl</code>). All the cholesterol/HDL, total cholesterol
and cholesterol/HDL measurements for each patient in the cohort of
interest are then extracted. The algorithm is as follows:</p>
<ul>
<li>Extract the most recent cholesterol/HDL, total cholesterol and
cholesterol/HDL measurements (within the specified time period)
according to the user inputted code lists. Observation dates identified
using variable <em>obsdate</em>.
<ul>
<li>The measurements must be non-missing</li>
<li>The cholesterol/HDL ratio measurements must be within the
user-defined valid range.</li>
</ul>
</li>
<li>All measurements are assumed to be in the correct unit of
measurement. .</li>
<li>Merge total cholesterol and HDL measurements.
<ul>
<li>Calculate cholesterol/HDL for every pair of total cholesterol and
HDL measurements using
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mfrac><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi><mi>c</mi><mi>h</mi><mi>o</mi><mi>l</mi><mi>e</mi><mi>s</mi><mi>t</mi><mi>e</mi><mi>r</mi><mi>o</mi><mi>l</mi></mrow><mrow><mi>H</mi><mi>D</mi><mi>L</mi></mrow></mfrac><annotation encoding="application/x-tex">\frac{total cholesterol}{HDL}</annotation></semantics></math>.</li>
<li>Remove cholesterol/HDL scores that are outside the specified
range.</li>
<li>Assign observation date to be the total cholesterol or HDL
measurement which occurred first.</li>
</ul>
</li>
<li>Merge the directly recorded cholesterol/HDL scores, with the
cholesterol/HDL scores calculated from total cholesterol and HDL.</li>
<li>Take the most recent cholesterol/HDL score within the specified time
period, whether it was a directly recorded cholesterol/HDL score, or
calculated from total cholesterol and HDL. If both are recorded on the
same date, the directly recorded cholesterol/HDL score takes
preference.</li>
</ul>
</div>
<div class="section level2">
<h2 id="diabetes-status-extract_diabetes">Diabetes status (<code>extract_diabetes</code>)<a class="anchor" aria-label="anchor" href="#diabetes-status-extract_diabetes"></a>
</h2>
<p>Extraction of diabetes status requires the user to specify two
codelists. One for type 1 diabetes (<code>codelist.type1</code>), and
another for type 2 diabetes (<code>codelist.type2</code>). The reason
this variable is not treated as a <code>history of</code> type variable
and extracted using <code>extract_ho</code> is because often individuals
will have a generic code such as <em>diabetes mellitus</em>, which would
be used to identify type 2 diabetes, but will also have a specific code
such as <em>type 1 diabetes mellitus</em>. This algorithm treats the two
as mutually exclusive, and assigns individuals with a code for both type
1 and type 1 diabetes, as having type 1 diabetes. The algorithm is as
follows:</p>
<ul>
<li>Extract type 1 diabetes and type 2 diabetes observations that
occurred prior to the index date. Observation dates identified using
variable <em>obsdate</em>.</li>
<li>Assign diabetes status.
<ul>
<li>If an individual has a code for both type 1 and type 2 diabetes,
assign diabetes type 1.</li>
</ul>
</li>
</ul>
</div>
<div class="section level2">
<h2 id="smoking-status-extract_smoking">Smoking status (<code>extract_smoking</code>)<a class="anchor" aria-label="anchor" href="#smoking-status-extract_smoking"></a>
</h2>
<p>Extraction of smoking status requires the user to specify five
codelists. One for non-smoker (<code>codelist.non</code>), one for
ex-smoker (<code>codelist.ex</code>), one for light smoker
(<code>codelist.light</code>), one for moderate smoker
(<code>codelist.moderate</code>) and one for heavy smoker
(<code>codelist.heavy</code>). For records identified using the light,
moderate or heavy smoker code lists, the <em>value</em> variable, which
represents number of cigarettes smoker per day, is used to modify the
outputted smoking status variable. This is to maximise the number of
observations that are defined in the same way (&lt; 10 day is light, 10
- 19 a day is moderate, &gt; 19 is heavy). The <em>value</em> variable
for observations recorded as ex-smoker are often denoting the number of
cigarettes per day the individual used to smoke, therefore this data is
not used to alter the smoking status. If an individuals most recent
record is a non-smoker, but an individual has previous records which
indicate a history of smoking, the smoking status is altered from
non-smoker to ex-smoker. The algorithm is as follows:</p>
<ul>
<li>Extract the 100 most recent non, ex, light, moderate and heavy
smoker observations according to the user inputted code lists.
Observation dates identified using variable <em>obsdate</em>.</li>
<li>If the <em>value</em> variable is non-missing for an observation
identified using the light, moderate or heavy smoker code lists,
re-define this to represent smoking status based on the following
definition:
<ul>
<li>1 - 9 per day = light smoker.</li>
<li>10 - 19 per day = moderate smoker.</li>
<li>19 - 100 per day = heavy smoker.</li>
<li>More than 100 per day, remove observation.</li>
</ul>
</li>
<li>Define smoking status to be the most recent observation.</li>
<li>If there are multiple on the same date, use the most severe smoking
status.</li>
<li>If the most recent observation is non-smoker, but there are codes
for ex, light, moderate or heavy smoker prior to this, change to
ex-smoker.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Alexander Pate.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
