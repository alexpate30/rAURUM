<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="rAURUM">
<title>user-guide • rAURUM</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.11/clipboard.min.js" integrity="sha512-7O5pXpc0oCRrxk8RUfDYFgn0nO1t+jLuIOQdOMRp4APB7uZ4vSjspzp5y6YDtDs4VzUSTbWzBFZ/LKJhnyFOKw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="user-guide">
<meta property="og:description" content="rAURUM">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light" data-bs-theme="light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">rAURUM</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/user-guide.html">user-guide</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav"></ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>user-guide</h1>
            
      
      
      <div class="d-none name"><code>user-guide.Rmd</code></div>
    </div>

    
    
<p><em>All data used in this vignette is simulated at random and does
not contain any real patient data.</em></p>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette will outline how to extract CPRD AURUM data for a
cohort of individuals using the package. There are two main
scenarios:</p>
<ul>
<li>Basic, all file directories are specified manually, etc</li>
<li>In-built. This requires file systems and directories to have a
specific set up. However, once the data is in this format, running the
extract should be much simpler.</li>
</ul>
<p>It will then showcase some basic functions for extracting variables
for this cohort, and how to build an analysis-ready dataset.</p>
<p>This package tackles a key problem, of working with the large CPRD
AURUM datasets in R. In the June 2021 extract, the raw files amount to
<strong>XXXX</strong> TB of data in .txt files. It is therefore
unfeasible to read all these files simultaneously into the R workspace,
and create a cohort in a straightforward way. We take the approach of
Springate et al., <strong>REF XXXX <a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5323003/" class="external-link uri">https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5323003/</a></strong>
by creating an SQLite database which can be saved onto the hard disk on
your computer system. This SQLite database can then be queried for data
of interest in order to build an analysis-ready dataset. This package is
inspired by rEHR and uses similar approaches, except relevant functions
are designed specifically for CPRD AURUM file types and variable
names.</p>
<p>This package can also be used to manage linked secondary care (HES)
and ONS death data, although this may less neccesary given the data will
not be as large.</p>
<p>A few key pieces of terminology that will be used in this
vignette:</p>
<ul>
<li>Raw data: The raw data provided to the user by CPRD.</li>
<li>Cohort: A cohort of individuals that meet the inclusion/exclusion
criteria for a given research question. In this setting, the cohort is
ultimately a vector of patient id’s.</li>
<li>Analysis-ready dataset: A data frame with one row for each
individual in the cohort, and a column for each variable of interest,
for example, age at cohort entry, or most recent BMI score prior to
cohort entry.</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://alexpate30.github.io/rAURUM/">rAURUM</a></span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: data.table</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cprd-aurum-data-structure">CPRD AURUM Data structure<a class="anchor" aria-label="anchor" href="#cprd-aurum-data-structure"></a>
</h2>
<p>This vignette assumes you are working with the ‘flatfiles’, which is
an extract of the entire CPRD AURUM database. For many research
projects, you may be provided only with data for individuals that meet a
certain inclusion criteria (i.e. a diagnoses of type 1 diabetes between
2000 - 2020). We believe the data is formatted the same way regardless
of whether you are working with the flatfiles or not, so this vignette
should still be relevant. <strong>Would be great to get someone who is
working with a dataset defined this way to test the package</strong>.
The CPRD AURUM data is split into eight different file types:
Consultation, DrugIssue, Observation, Patient, Practice, Problem,
Referral, Staff. The data specification is available here: <a href="https://cprd.com/sites/default/files/2022-02/CPRD%20Aurum%20Data%20Specification%20v2.7%20%28002%29.pdf" class="external-link uri">https://cprd.com/sites/default/files/2022-02/CPRD%20Aurum%20Data%20Specification%20v2.7%20%28002%29.pdf</a>.
For most research questions, the relevant files are Patient, Observation
and DrugIssue. The Patient file is often required to define the cohort.
Observation contains all medical diagnoses and tests, while DrugIssue
contains all information on prescriptions. There is a limit on file size
in the raw data, and so each of the above file types is commonly split
up into numerous individual files.</p>
<p>The patient files are split up into groups of <strong>CHECK THIS
XXXX</strong> 1,000,0000 individuals, denoted by set1, set2, set3, etc.
There will be more than 1 Observation and DrugIssue file for each set of
patients, because the file sizes are capped at 1GB. The observation
files for patients in <em>setX</em>, will have the corresponding set
number in the file name, and then a suffix 1, 2, 3, etc. The same is
true for the DrugIssue files. The naming structure for these is as
follows:</p>
<ul>
<li>aurum_allpatid_set<em>X</em>_extract_patient_001.txt</li>
<li>aurum_allpatid_set<em>X</em>_extract_observation_00<em>Y</em>.txt</li>
<li>aurum_allpatid_set<em>X</em>_extract_drugissue_00<em>Y</em>.txt</li>
</ul>
<p>where <em>X</em> and <em>Y</em> take integer values. We have provided
simulated .txt patient, Observation and DrugIssue files with these
naming conventions. This contains data on 6 fake patients from set 1,
split across three observation and DrugIssue files. Note the “allpatid”
in the filenames denotes that we are working with the entire CPRD AURUM
database. This part of the filename may be altered if you have only been
provided with data on a subset of individuals, however we expect the set
<em>X</em> and suffix <em>Y</em> naming convention to be the same. We
will showcase two approaches to extracting data for a cohort, one which
is reliant on the data structure and naming conventions to reduce
computational time, and one which has no reliance on these things.</p>
</div>
<div class="section level2">
<h2 id="overarching-process">Overarching process<a class="anchor" aria-label="anchor" href="#overarching-process"></a>
</h2>
<p>Our recommended process is as follows:</p>
<ul>
<li>Step 1: Define cohort of interest by applying inclusion/exclusion
criteria.</li>
<li>Step 2: Read raw data for cohort of interest into R and write into
an SQLite database.</li>
<li>Step 3: Query this SQLite database for specific codes and tests to
create variables for each individual in the cohort.</li>
<li>Step 4: Combine extracted variables into an analysis-ready
dataset.</li>
</ul>
<p>We recommend this process for the following reasons. Once set up,
querying the SQLite database is computationally much quicker than
reading in all the raw .txt files and querying these. It also reduces
the possibility of error from looping through the raw .txt files
numerous times. Note that in some instances CPRD will apply the
inclusion/exclusion criteria and provide a list of patid’s to the user.
In this case, step 1 can be ignored and the first step will be to create
the SQLite database.</p>
</div>
<div class="section level2">
<h2 id="defining-a-cohort">Defining a cohort<a class="anchor" aria-label="anchor" href="#defining-a-cohort"></a>
</h2>
<p>This section is only applicable if the user is required to define a
cohort using the raw data.</p>
<p>The first step is to define a cohort based on your inclusion and
exclusion criteria. The simulated patient data for 6 individuals is
contained in the file aurum_allpatid_set1_extract_patient_001.txt. We
read this in using the function <code>extract_txt_pat</code>, which is
just a wrapper for <code>read.table</code> which formats the variables
appropriately.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_txt_pat.html">extract_txt_pat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, <span class="st">"aurum_allpatid_set1_extract_patient_001.txt"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pat</span></span>
<span><span class="co">#&gt;   patid pracid usualgpstaffid gender  yob mob emis_ddate regstartdate</span></span>
<span><span class="co">#&gt; 1     1     49              6      2 1984  NA 1976-11-21   1940-07-24</span></span>
<span><span class="co">#&gt; 2     2     79             11      1 1932  NA 1979-02-14   1929-02-23</span></span>
<span><span class="co">#&gt; 3     3     98             43      1 1930  NA 1972-06-01   1913-07-02</span></span>
<span><span class="co">#&gt; 4     4     53             72      2 1915  NA 1989-04-24   1969-07-11</span></span>
<span><span class="co">#&gt; 5     5     62             16      2 1916  NA 1951-09-23   1919-11-07</span></span>
<span><span class="co">#&gt; 6     6     54             11      1 1914  NA 1926-09-09   1970-08-28</span></span>
<span><span class="co">#&gt;   patienttypeid regenddate acceptable cprd_ddate</span></span>
<span><span class="co">#&gt; 1            58 1996-08-25          1 1935-03-17</span></span>
<span><span class="co">#&gt; 2            21 1945-03-19          0 1932-02-05</span></span>
<span><span class="co">#&gt; 3            81 1997-04-24          1 1912-04-27</span></span>
<span><span class="co">#&gt; 4            10 1951-09-05          0 1921-02-13</span></span>
<span><span class="co">#&gt; 5            45 1998-11-25          0 1903-08-26</span></span>
<span><span class="co">#&gt; 6            85 1983-03-14          1 1963-08-27</span></span></code></pre></div>
<p>In this example, we define our cohort to be those individuals with
patids 1, 3, 4 and 6. When creating the SQLite database, you therefore
only want to extract data for these individuals. In practice, the
patient data would be split across a number of different files, which
would need to be read into R individually and concatenated.The cohort of
individuals would then be defined by applying study specific
inclusion/exclusion criteria. For example, all individuals with &gt; 1
day valid follow up aged 65+, after 1st January 2000. Such criteria can
be applied solely using the information available in patient files.</p>
<p>However, it is common for inclusion/exclusion criteria to also be
dependent on medical diagnoses and prescription history. For example,
there may be an additional inclusion criteria that individuals must have
a history of type 2 diabetes. To apply this criteria and reduce the
cohort further, you must first extract medical history data for the
cohort. In this case, the above steps may be altered to:</p>
<ul>
<li>Step 1: Define cohort of interest by applying inclusion/exclusion
criteria that are not dependent on medical history.</li>
<li>Step 2: Read raw data for cohort of interest into R and write into
an SQLite database.</li>
<li>Step 3: Query this SQLite database for specific codes and tests to
apply remaining inclusion/exclusion criteria that are dependent on
medical history.</li>
<li>Step 4: [Optional] Reduce SQLite database to only contain data on
individuals in final cohort. This may be worthwhile if the
inclusion/exclusion criteria in step 3 excluded a large number of
individuals. This will mean future queries into the SQLite database will
run much quicker.</li>
<li>Step 5: Query this SQLite database for specific codes and tests to
create variables for each individual in the cohort.</li>
<li>Step 6: Combine extracted variables into an analysis-ready
dataset.</li>
</ul>
</div>
<div class="section level2">
<h2 id="creating-an-sqlite-database">Creating an SQLite database<a class="anchor" aria-label="anchor" href="#creating-an-sqlite-database"></a>
</h2>
<p>Data for individuals in the cohort of interest is extracted from the
.txt files and put into a SQLite database. This SQLite database is
stored on the hard disk and can be queried when defining an
analysis-ready dataset.</p>
<div class="section level3">
<h3 id="add-individual-files-to-sqlite-database-using-add_to_database">Add individual files to SQLite database using
<code>add_to_database</code><a class="anchor" aria-label="anchor" href="#add-individual-files-to-sqlite-database-using-add_to_database"></a>
</h3>
<p>In the most basic application of , the function
<code>add_to_database</code> can be used to add data from a text file to
the SQLite database. Start by defining and connecting to your SQLite
database. In this vignette we create a temporary database, but in
practice this would be a permanent location the hard disk.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aurum_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect_database.html">connect_database</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"temp.sqlite"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Next we add medical diagnoses data from the observation files to a
table within this database, which we call <code>obs</code>, using the
<code>add_to_database</code> function. The simulated raw data provided
with can be accessed using the <code>system.file</code> function. The
vector of patient id’s that defines the cohort is defined through the
<code>subset.patids</code> argument. Only data with patid’s matching
this argument will be added to the SQLite database.The
<code>filetype</code> argument will select an appropriate function for
reading in the .txt files, and also defines the name of the table in the
SQLite database that the files are added to. Note that for the first
file, <code>overwrite = TRUE</code> is specified to create a new table.
For the second and third file, <code>append = TRUE</code> is specified
to append to an existing table.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/add_to_database.html">add_to_database</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, <span class="st">"aurum_allpatid_set1_extract_observation_001.txt"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, </span>
<span>                filetype <span class="op">=</span> <span class="st">"observation"</span>, nrows <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, select <span class="op">=</span> <span class="cn">NULL</span>, subset.patids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, use.set <span class="op">=</span> <span class="cn">FALSE</span>, db <span class="op">=</span> <span class="va">aurum_extract</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_to_database.html">add_to_database</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, <span class="st">"aurum_allpatid_set1_extract_observation_001.txt"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, </span>
<span>                filetype <span class="op">=</span> <span class="st">"observation"</span>, subset.patids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, db <span class="op">=</span> <span class="va">aurum_extract</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_to_database.html">add_to_database</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, <span class="st">"aurum_allpatid_set1_extract_observation_001.txt"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, </span>
<span>                filetype <span class="op">=</span> <span class="st">"observation"</span>, subset.patids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, db <span class="op">=</span> <span class="va">aurum_extract</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>We can then query this database, by selecting all rows from the
<em>observation</em> table, and only printing the first 3. More details
on how to query an SQLite database using is available <strong>HERE XXXX
REF</strong>. Note that when reading the .txt data into R, the dates are
converted into date formats, with a underlying numeric value where day 0
is 01/01/1970. When saved to the SQLite database, it is the underlying
numeric values which is saved, hence the dates now appearing as numeric
values.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">aurum_extract</span>, <span class="st">'SELECT * FROM observation'</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patid consid pracid obsid obsdate enterdate staffid parentobsid</span></span>
<span><span class="co">#&gt; 1     1     33      1   100  -15931      -994      79          95</span></span>
<span><span class="co">#&gt; 2     1     66      1    46  -13782    -15232      34          17</span></span>
<span><span class="co">#&gt; 3     1     41      1    53  -20002      8845      35          79</span></span>
<span><span class="co">#&gt;           medcodeid value numunitid obstypeid numrangelow numrangehigh</span></span>
<span><span class="co">#&gt; 1   498521000006119    48        16        20          28           86</span></span>
<span><span class="co">#&gt; 2         401539014    22         1         2          27            8</span></span>
<span><span class="co">#&gt; 3 13483031000006114    17        78        13          87           41</span></span>
<span><span class="co">#&gt;   probobsid</span></span>
<span><span class="co">#&gt; 1        54</span></span>
<span><span class="co">#&gt; 2        35</span></span>
<span><span class="co">#&gt; 3        74</span></span></code></pre></div>
<p>Next we add the prescription data from the DrugIssue files to a table
called <code>drugissue</code>.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/add_to_database.html">add_to_database</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, <span class="st">"aurum_allpatid_set1_extract_drugissue_001.txt"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, </span>
<span>                filetype <span class="op">=</span> <span class="st">"drugissue"</span>, nrows <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, select <span class="op">=</span> <span class="cn">NULL</span>, subset.patids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, use.set <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">aurum_extract</span>, overwrite <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_to_database.html">add_to_database</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, <span class="st">"aurum_allpatid_set1_extract_drugissue_001.txt"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, </span>
<span>                filetype <span class="op">=</span> <span class="st">"drugissue"</span>, nrows <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, select <span class="op">=</span> <span class="cn">NULL</span>, subset.patids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, use.set <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">aurum_extract</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/add_to_database.html">add_to_database</a></span><span class="op">(</span>filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, <span class="st">"aurum_allpatid_set1_extract_drugissue_001.txt"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, </span>
<span>                filetype <span class="op">=</span> <span class="st">"drugissue"</span>, nrows <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, select <span class="op">=</span> <span class="cn">NULL</span>, subset.patids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, use.set <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">aurum_extract</span>, append <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>Again we can then query this table, by selecting all rows from the
<em>drugissue</em> table, and only printing the first 3.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">aurum_extract</span>, <span class="st">'SELECT * FROM drugissue'</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patid issueid pracid probobsid drugrecid issuedate enterdate staffid</span></span>
<span><span class="co">#&gt; 1     1      93      1        88        83    -16118     -1013      98</span></span>
<span><span class="co">#&gt; 2     1      93      1        55        59    -13322    -12900      88</span></span>
<span><span class="co">#&gt; 3     1      16      1        22        82     -8677     -3543      50</span></span>
<span><span class="co">#&gt;         prodcodeid dosageid quantity quantunitid duration estnhscost quanunitid</span></span>
<span><span class="co">#&gt; 1 3092241000033113       58       18          33       27         12          6</span></span>
<span><span class="co">#&gt; 2   92041000033111       62       93          83       59         11         25</span></span>
<span><span class="co">#&gt; 3  971241000033111       87       43          83       88         65         92</span></span></code></pre></div>
<p>We can list all the tables in the SQLite database and see there are
now two, named <em>observation</em> and <em>drugissue</em>.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbListTables</span><span class="op">(</span><span class="va">aurum_extract</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "drugissue"   "observation"</span></span></code></pre></div>
<p>The <code>add_to_database</code> function allows specification of
<code>filetype = c("observation", "drugissue", "referral", "problem", "consultation", "hes_primary","death")</code>,
each corresponding to a specific function for reading in the
corresponding .txt files with correct formatting. The
<code>"hes_primary"</code> options correspond to the primary diagnoses
file in linked HES APC data. The <code>"death"</code> file corresponds
to the death file in the linked ONS data.</p>
<p>Finally, when manually adding files in this manner, it is good
practice to close the connection to the SQLite database once
finished.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">aurum_extract</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="add-all-relevant-files-to-sqlite-database-using-cprd_extract">Add all relevant files to SQLite database using
<code>cprd_extract</code><a class="anchor" aria-label="anchor" href="#add-all-relevant-files-to-sqlite-database-using-cprd_extract"></a>
</h3>
<p>In practice, there will be a high number of files to add to the
SQLite database and adding each one using <code>add_to_database</code>
would be cumbersome. We now we repeat the extraction but using the
cprd_extract function, which is a wrapper for
<code>add_to_database</code>, and will add all the files in a specified
directory.</p>
<p>Start by creating a connection to a new database (again, we use a
temporary database, but this would be a permanent file on the hard disk
in practice).</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">aurum_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect_database.html">connect_database</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"temp.sqlite"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>We then use <code>cprd_extract</code> to add all the observation
files into the SQLite database. The directory containing the files
should be specified using <code>filepath</code>. It will only read in
and add files with the text string specified in <code>filetype</code>,
which takes values in
<code>c("observation", "drugissue", "referral", "problem", "consultation")</code>.
We then query the first three rows of this database, and note they are
the same as previously.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Extract data</span></span>
<span><span class="fu"><a href="../reference/cprd_extract.html">cprd_extract</a></span><span class="op">(</span><span class="va">aurum_extract</span>, </span>
<span>             filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, </span>
<span>             filetype <span class="op">=</span> <span class="st">"observation"</span>, subset.patids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, use.set <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nrows -1"</span></span>
<span><span class="co">#&gt; [1] "select "</span></span>
<span><span class="co">#&gt; [1] "use.set FALSE"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_observation_001.txt 2024-06-07 14:52:35.91071"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_observation_002.txt 2024-06-07 14:52:35.923195"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_observation_003.txt 2024-06-07 14:52:35.934128"</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### Query first three rows</span></span>
<span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">aurum_extract</span>, <span class="st">'SELECT * FROM observation'</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patid consid pracid obsid obsdate enterdate staffid parentobsid</span></span>
<span><span class="co">#&gt; 1     1     33      1   100  -15931      -994      79          95</span></span>
<span><span class="co">#&gt; 2     1     66      1    46  -13782    -15232      34          17</span></span>
<span><span class="co">#&gt; 3     1     41      1    53  -20002      8845      35          79</span></span>
<span><span class="co">#&gt;           medcodeid value numunitid obstypeid numrangelow numrangehigh</span></span>
<span><span class="co">#&gt; 1   498521000006119    48        16        20          28           86</span></span>
<span><span class="co">#&gt; 2         401539014    22         1         2          27            8</span></span>
<span><span class="co">#&gt; 3 13483031000006114    17        78        13          87           41</span></span>
<span><span class="co">#&gt;   probobsid</span></span>
<span><span class="co">#&gt; 1        54</span></span>
<span><span class="co">#&gt; 2        35</span></span>
<span><span class="co">#&gt; 3        74</span></span></code></pre></div>
<p>The process is then repeated for the drugissue files.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Extract data</span></span>
<span><span class="fu"><a href="../reference/cprd_extract.html">cprd_extract</a></span><span class="op">(</span><span class="va">aurum_extract</span>, </span>
<span>             filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, </span>
<span>             filetype <span class="op">=</span> <span class="st">"drugissue"</span>, subset.patids <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span>, use.set <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nrows -1"</span></span>
<span><span class="co">#&gt; [1] "select "</span></span>
<span><span class="co">#&gt; [1] "use.set FALSE"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_drugissue_001.txt 2024-06-07 14:52:36.015269"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_drugissue_002.txt 2024-06-07 14:52:36.027327"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_drugissue_003.txt 2024-06-07 14:52:36.038158"</span></span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### List tables</span></span>
<span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbListTables</span><span class="op">(</span><span class="va">aurum_extract</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "drugissue"   "observation"</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### Query first three rows</span></span>
<span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">aurum_extract</span>, <span class="st">'SELECT * FROM drugissue'</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patid issueid pracid probobsid drugrecid issuedate enterdate staffid</span></span>
<span><span class="co">#&gt; 1     1      93      1        88        83    -16118     -1013      98</span></span>
<span><span class="co">#&gt; 2     1      93      1        55        59    -13322    -12900      88</span></span>
<span><span class="co">#&gt; 3     1      16      1        22        82     -8677     -3543      50</span></span>
<span><span class="co">#&gt;         prodcodeid dosageid quantity quantunitid duration estnhscost quanunitid</span></span>
<span><span class="co">#&gt; 1 3092241000033113       58       18          33       27         12          6</span></span>
<span><span class="co">#&gt; 2   92041000033111       62       93          83       59         11         25</span></span>
<span><span class="co">#&gt; 3  971241000033111       87       43          83       88         65         92</span></span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### Disconnect</span></span>
<span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">aurum_extract</span><span class="op">)</span></span></code></pre></div>
<p>Note that this function may run for a considerable period of time
when working with the entire CPRD AURUM database, and therefore it is
not recommended to run interactively. While creation of the SQLite
database may be time consuming, subsequent queries will be far more
efficient, so this is short term pain for a long term gain.</p>
</div>
<div class="section level3">
<h3 id="add-all-relevant-files-to-sqlite-database-in-a-comptationally-efficient-manner-using-the-set-functionality-">Add all relevant files to SQLite database in a comptationally
efficient manner using the <code>set</code> functionality.<a class="anchor" aria-label="anchor" href="#add-all-relevant-files-to-sqlite-database-in-a-comptationally-efficient-manner-using-the-set-functionality-"></a>
</h3>
<p>When the number of patients in your cohort is very large (say
20,000,000, which was the case for us), the <code>add_to_database</code>
function may perform very slowly. This is because it checks to see
whether the patid for each observation in the file being added to the
SQLite database, is contained in the vector <code>subset.patids</code>
(a vector of length 20,000,000 in our case). We can utilise the
structure of the CPRD AURUM data to speed up this process. If data has
been provided using the <em>set</em> structure (see previous section),
we know that we only need to search for patids from
<code>subset.patids</code>, that are in the corresponding patient file.
For example, when reading in file
<em>aurum_allpatid_set1_extract_observation_00Y.txt</em> (for any
<em>Y</em>), we only need to search whether paatid is in the vector of
patids from <code>subset.patid</code>, that are also in
<em>aurum_allpatid_set1_extract_patient_001.txt</em>, which is much
smaller vector. This may seem excessive, but in our case this reduced
the time that <code>add_to_database</code> took to run from hours to
minutes. When running <code>cprd_extract</code> on hundreds on files,
this reduced months of computation time (infeasible) to days.</p>
<p>To achieve this, the <code>subset.patids</code> object should be a
dataframe with two required columns. The first column should be
<code>patid</code>, the second should be <code>set</code>, reporting the
corresponding value of set which the patient belongs to. The first step
is therefore to create a patient file, which has an extra variable
<code>set</code>, which indicates the number following the text string
<em>set</em> in the patient file containing data for that patient. When
reading in the patient files to create your cohort, this can be done
using the function <code>extract_txt_pat</code>, and specifying
<code>set = TRUE</code>. Note that in this example there is only one
patient file, with <code>set = 1</code>, but in practice there would be
numerous patient files that would need to be read in and concatenated to
create your cohort.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">pat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_txt_pat.html">extract_txt_pat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, <span class="st">"aurum_allpatid_set1_extract_patient_001.txt"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, set <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">pat</span></span>
<span><span class="co">#&gt;   patid pracid usualgpstaffid gender  yob mob emis_ddate regstartdate</span></span>
<span><span class="co">#&gt; 1     1     49              6      2 1984  NA 1976-11-21   1940-07-24</span></span>
<span><span class="co">#&gt; 2     2     79             11      1 1932  NA 1979-02-14   1929-02-23</span></span>
<span><span class="co">#&gt; 3     3     98             43      1 1930  NA 1972-06-01   1913-07-02</span></span>
<span><span class="co">#&gt; 4     4     53             72      2 1915  NA 1989-04-24   1969-07-11</span></span>
<span><span class="co">#&gt; 5     5     62             16      2 1916  NA 1951-09-23   1919-11-07</span></span>
<span><span class="co">#&gt; 6     6     54             11      1 1914  NA 1926-09-09   1970-08-28</span></span>
<span><span class="co">#&gt;   patienttypeid regenddate acceptable cprd_ddate set</span></span>
<span><span class="co">#&gt; 1            58 1996-08-25          1 1935-03-17   1</span></span>
<span><span class="co">#&gt; 2            21 1945-03-19          0 1932-02-05   1</span></span>
<span><span class="co">#&gt; 3            81 1997-04-24          1 1912-04-27   1</span></span>
<span><span class="co">#&gt; 4            10 1951-09-05          0 1921-02-13   1</span></span>
<span><span class="co">#&gt; 5            45 1998-11-25          0 1903-08-26   1</span></span>
<span><span class="co">#&gt; 6            85 1983-03-14          1 1963-08-27   1</span></span></code></pre></div>
<p>The patient file read in is the same as previously, with the addition
of the <code>set</code> column. This file can be reduced to just the
<code>patid</code> and <code>set</code> columsn, and used as the input
to <code>subset.patids</code> when running the
<code>add_to_database</code> and <code>cprd_extract</code> functions.
When extracting data from observation files with <em>set1</em> in the
name, it will only search for patient id’s with <code>set == 1</code> in
the data.frame provided to <code>subset.patids</code>.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Reduce patient cohort to just variables "patid" and "set", and where patid = 1, 3, 4 and 6.</span></span>
<span><span class="va">pat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html" class="external-link">subset</a></span><span class="op">(</span><span class="va">pat</span>, <span class="va">patid</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">6</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">pat</span></span>
<span><span class="co">#&gt;   patid pracid usualgpstaffid gender  yob mob emis_ddate regstartdate</span></span>
<span><span class="co">#&gt; 1     1     49              6      2 1984  NA 1976-11-21   1940-07-24</span></span>
<span><span class="co">#&gt; 3     3     98             43      1 1930  NA 1972-06-01   1913-07-02</span></span>
<span><span class="co">#&gt; 4     4     53             72      2 1915  NA 1989-04-24   1969-07-11</span></span>
<span><span class="co">#&gt; 6     6     54             11      1 1914  NA 1926-09-09   1970-08-28</span></span>
<span><span class="co">#&gt;   patienttypeid regenddate acceptable cprd_ddate set</span></span>
<span><span class="co">#&gt; 1            58 1996-08-25          1 1935-03-17   1</span></span>
<span><span class="co">#&gt; 3            81 1997-04-24          1 1912-04-27   1</span></span>
<span><span class="co">#&gt; 4            10 1951-09-05          0 1921-02-13   1</span></span>
<span><span class="co">#&gt; 6            85 1983-03-14          1 1963-08-27   1</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### Create connection to SQLite database</span></span>
<span><span class="va">aurum_extract</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/connect_database.html">connect_database</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempfile</a></span><span class="op">(</span><span class="st">"temp.sqlite"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Add observation files</span></span>
<span><span class="fu"><a href="../reference/cprd_extract.html">cprd_extract</a></span><span class="op">(</span><span class="va">aurum_extract</span>, </span>
<span>             filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, </span>
<span>             filetype <span class="op">=</span> <span class="st">"observation"</span>, nrows <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, select <span class="op">=</span> <span class="cn">NULL</span>, subset.patids <span class="op">=</span> <span class="va">pat</span>, use.set <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nrows -1"</span></span>
<span><span class="co">#&gt; [1] "select "</span></span>
<span><span class="co">#&gt; [1] "use.set TRUE"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_observation_001.txt 2024-06-07 14:52:36.195492"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_observation_002.txt 2024-06-07 14:52:36.211224"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_observation_003.txt 2024-06-07 14:52:36.223759"</span></span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### Add drugissue files</span></span>
<span><span class="fu"><a href="../reference/cprd_extract.html">cprd_extract</a></span><span class="op">(</span><span class="va">aurum_extract</span>, </span>
<span>             filepath <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"aurum_data"</span>, package <span class="op">=</span> <span class="st">"rAURUM"</span><span class="op">)</span>, </span>
<span>             filetype <span class="op">=</span> <span class="st">"drugissue"</span>, nrows <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, select <span class="op">=</span> <span class="cn">NULL</span>, subset.patids <span class="op">=</span> <span class="va">pat</span>, use.set <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "nrows -1"</span></span>
<span><span class="co">#&gt; [1] "select "</span></span>
<span><span class="co">#&gt; [1] "use.set TRUE"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_drugissue_001.txt 2024-06-07 14:52:36.23984"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_drugissue_002.txt 2024-06-07 14:52:36.253414"</span></span>
<span><span class="co">#&gt; [1] "/home/runner/work/_temp/Library/rAURUM/aurum_data/aurum_allpatid_set1_extract_drugissue_003.txt 2024-06-07 14:52:36.265821"</span></span></code></pre></div>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### Query first three rows of each table</span></span>
<span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">aurum_extract</span>, <span class="st">'SELECT * FROM observation'</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patid consid pracid obsid obsdate enterdate staffid parentobsid</span></span>
<span><span class="co">#&gt; 1     1     33      1   100  -15931      -994      79          95</span></span>
<span><span class="co">#&gt; 2     1     66      1    46  -13782    -15232      34          17</span></span>
<span><span class="co">#&gt; 3     1     41      1    53  -20002      8845      35          79</span></span>
<span><span class="co">#&gt;           medcodeid value numunitid obstypeid numrangelow numrangehigh</span></span>
<span><span class="co">#&gt; 1   498521000006119    48        16        20          28           86</span></span>
<span><span class="co">#&gt; 2         401539014    22         1         2          27            8</span></span>
<span><span class="co">#&gt; 3 13483031000006114    17        78        13          87           41</span></span>
<span><span class="co">#&gt;   probobsid</span></span>
<span><span class="co">#&gt; 1        54</span></span>
<span><span class="co">#&gt; 2        35</span></span>
<span><span class="co">#&gt; 3        74</span></span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbGetQuery</span><span class="op">(</span><span class="va">aurum_extract</span>, <span class="st">'SELECT * FROM drugissue'</span>, n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span><span class="co">#&gt;   patid issueid pracid probobsid drugrecid issuedate enterdate staffid</span></span>
<span><span class="co">#&gt; 1     1      93      1        88        83    -16118     -1013      98</span></span>
<span><span class="co">#&gt; 2     1      93      1        55        59    -13322    -12900      88</span></span>
<span><span class="co">#&gt; 3     1      16      1        22        82     -8677     -3543      50</span></span>
<span><span class="co">#&gt;         prodcodeid dosageid quantity quantunitid duration estnhscost quanunitid</span></span>
<span><span class="co">#&gt; 1 3092241000033113       58       18          33       27         12          6</span></span>
<span><span class="co">#&gt; 2   92041000033111       62       93          83       59         11         25</span></span>
<span><span class="co">#&gt; 3  971241000033111       87       43          83       88         65         92</span></span></code></pre></div>
<p>Note that there is no difference compared to the previously extracted
SQLite databases. The computational gains from applying the subsetting
in this manner will not be realised in this example. We do not close the
connection, as we will now move onto querying the database to extract
variables for creating an analysis-ready dataset.</p>
</div>
</div>
<div class="section level2">
<h2 id="creating-an-analysis-ready-dataset">Creating an analysis-ready dataset<a class="anchor" aria-label="anchor" href="#creating-an-analysis-ready-dataset"></a>
</h2>
<p>Once the data has been extracted and stored in an SQLite database, it
can now be queried to create variables of interest. The
<code>db_query</code> function will query the SQLite database for
observations where medcodeid is in a specified codelist. For example, we
can query the <em>observation</em> table for all codes with medcodeid of
<em>187341000000114</em>.</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">db.query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/db_query.html">db_query</a></span><span class="op">(</span>db.open <span class="op">=</span> <span class="va">aurum_extract</span>,</span>
<span>                     tab <span class="op">=</span><span class="st">"observation"</span>,</span>
<span>                     codelist.vector <span class="op">=</span> <span class="st">"187341000000114"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">db.query</span></span>
<span><span class="co">#&gt;     patid consid pracid  obsid obsdate enterdate staffid parentobsid</span></span>
<span><span class="co">#&gt;    &lt;char&gt; &lt;char&gt;  &lt;int&gt; &lt;char&gt;   &lt;num&gt;     &lt;num&gt;  &lt;char&gt;      &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1:      1     42      1     81   -5373      4302      85          35</span></span>
<span><span class="co">#&gt; 2:      6     40      1     41  -14727     -6929      98          80</span></span>
<span><span class="co">#&gt;          medcodeid value numunitid obstypeid numrangelow numrangehigh probobsid</span></span>
<span><span class="co">#&gt;             &lt;char&gt; &lt;num&gt;     &lt;int&gt;     &lt;int&gt;       &lt;num&gt;        &lt;num&gt;    &lt;char&gt;</span></span>
<span><span class="co">#&gt; 1: 187341000000114    84        79        67          24           22         5</span></span>
<span><span class="co">#&gt; 2: 187341000000114    28        20         5          41           97        92</span></span></code></pre></div>
<p>The <code>combine_query_boolean</code> function will assess whether
each individual in a specified cohort has an observation in the queried
data (obtained using <code>db_query</code>) within a specified time
frame from the index date, returning a 0/1 vector. The
<code>cohort</code> must contain a variable called <code>indexdt</code>
containing the index date. This function is useful when defining
‘history of’ type variables, where we want to know if there is any
record of a given condition prior to the index date.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Add an index date to pat</span></span>
<span><span class="va">pat</span><span class="op">$</span><span class="va">indexdt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"01/01/2020"</span>, format <span class="op">=</span> <span class="st">"%d/%m/%Y"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Extract a history of type variable using extract_ho</span></span>
<span><span class="va">combine.query.boolean</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_query_boolean.html">combine_query_boolean</a></span><span class="op">(</span>cohort <span class="op">=</span> <span class="va">pat</span>,</span>
<span>                                               db.query <span class="op">=</span> <span class="va">db.query</span>,</span>
<span>                                               query.type <span class="op">=</span> <span class="st">"observation"</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">combine.query.boolean</span></span>
<span><span class="co">#&gt; [1] 1 0 0 1</span></span></code></pre></div>
<p>The <code>combine_query</code> function will merge a cohort with the
queried data (obtained using <code>db_query</code>), returning a
specified number of observations (<code>numobs</code>) within a
specified time frame from the index date. This is useful when extracting
test data and requiring access to the values of the tests, or when
specifying variables that require &gt; 1 observation within a certain
time frame (i.e. two prescriptions within a month prior to index date).
For queries from the <code>observation</code> table, the query type can
be specified as <code>"med"</code> or <code>"test"</code>. Inputting
<code>query.type = "med"</code> will just return the date of the
observations and the medcodeid.</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Extract a history of type variable using extract_ho</span></span>
<span><span class="va">combine.query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_query.html">combine_query</a></span><span class="op">(</span>cohort <span class="op">=</span> <span class="va">pat</span>,</span>
<span>                               db.query <span class="op">=</span> <span class="va">db.query</span>,</span>
<span>                               query.type <span class="op">=</span> <span class="st">"med"</span>,</span>
<span>                               numobs <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">combine.query</span></span>
<span><span class="co">#&gt;     patid       medcodeid obsdate</span></span>
<span><span class="co">#&gt;    &lt;char&gt;          &lt;char&gt;   &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      1 187341000000114   -5373</span></span>
<span><span class="co">#&gt; 2:      6 187341000000114  -14727</span></span></code></pre></div>
<p>For <code>query.type = "test"</code>, the <code>value</code> and
other relevant information will also be returned, and those with NA
values removed (although this can be altered through argument
<code>value.na.rm</code>).</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Extract a history of type variable using extract_ho</span></span>
<span><span class="va">combine.query</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/combine_query.html">combine_query</a></span><span class="op">(</span>cohort <span class="op">=</span> <span class="va">pat</span>,</span>
<span>                               db.query <span class="op">=</span> <span class="va">db.query</span>,</span>
<span>                               query.type <span class="op">=</span> <span class="st">"test"</span>,</span>
<span>                               numobs <span class="op">=</span> <span class="fl">3</span><span class="op">)</span></span>
<span>  </span>
<span><span class="va">combine.query</span></span>
<span><span class="co">#&gt;     patid       medcodeid obsdate value numunitid numrangelow numrangehigh</span></span>
<span><span class="co">#&gt;    &lt;char&gt;          &lt;char&gt;   &lt;num&gt; &lt;num&gt;     &lt;int&gt;       &lt;num&gt;        &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1:      1 187341000000114   -5373    84        79          24           22</span></span>
<span><span class="co">#&gt; 2:      6 187341000000114  -14727    28        20          41           97</span></span></code></pre></div>
<p>If the query was from the <code>drugissue</code> table, then
<code>query.type = "drugissue"</code> should be specified.</p>
<p>However, it is not always necessary to work with these functions
directly. We have written a number of functions which should cover the
extraction of common variable types. The first is
<code>extract_ho</code>, which defines a binary variable whether
individual has a specified code recorded prior to index date. This can
be applied to search for history of medical diagnoses or prescriptions.
The second is <code>extract_time_until</code>, which defines a variable
for time until the first of a record of a specified code or censoring,
and an indicator for whether event was observed or censored. The third
is <code>extract_test</code>, which will extract test results between a
given time frame for a specified code list. Below are an example of each
function. We use the same codelist (of length 1) for each function,
given the data is simulated and we know this code is present in the
data. Argument <code>return.output = TRUE</code> will return the
outputted data frame into the R workspace. Further functionality of
these functions can be found in the function documentation.</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Read in codelist</span></span>
<span><span class="va">codelist</span> <span class="op">&lt;-</span> <span class="st">"187341000000114"</span></span>
<span></span>
<span><span class="co">### Add an index date to pat</span></span>
<span><span class="va">pat</span><span class="op">$</span><span class="va">fup_start</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"01/01/2020"</span>, format <span class="op">=</span> <span class="st">"%d/%m/%Y"</span><span class="op">)</span></span>
<span><span class="va">pat</span><span class="op">$</span><span class="va">fup_end</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.Date.html" class="external-link">as.Date</a></span><span class="op">(</span><span class="st">"01/01/2024"</span>, format <span class="op">=</span> <span class="st">"%d/%m/%Y"</span><span class="op">)</span></span>
<span></span>
<span><span class="co">### Extract a history of type variable using extract_ho</span></span>
<span><span class="va">ho</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_ho.html">extract_ho</a></span><span class="op">(</span><span class="va">pat</span>, </span>
<span>                 codelist.vector <span class="op">=</span> <span class="va">codelist</span>, </span>
<span>                 indexdt <span class="op">=</span> <span class="st">"fup_start"</span>, </span>
<span>                 db.open <span class="op">=</span> <span class="va">aurum_extract</span>, </span>
<span>                 tab <span class="op">=</span> <span class="st">"observation"</span>,</span>
<span>                 return.output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">ho</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    4 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ patid: chr  "1" "3" "4" "6"</span></span>
<span><span class="co">#&gt;  $ ho   : int  1 0 0 1</span></span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### Extract a time until variable using extract_time_until</span></span>
<span><span class="va">time_until</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_time_until.html">extract_time_until</a></span><span class="op">(</span><span class="va">pat</span>, </span>
<span>                                 codelist.vector <span class="op">=</span> <span class="va">codelist</span>, </span>
<span>                                 indexdt <span class="op">=</span> <span class="st">"fup_start"</span>, </span>
<span>                                 censdt <span class="op">=</span> <span class="st">"fup_end"</span>,</span>
<span>                                 db.open <span class="op">=</span> <span class="va">aurum_extract</span>, </span>
<span>                                 tab <span class="op">=</span> <span class="st">"observation"</span>,</span>
<span>                                 return.output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">time_until</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    4 obs. of  3 variables:</span></span>
<span><span class="co">#&gt;  $ patid        : chr  "1" "3" "4" "6"</span></span>
<span><span class="co">#&gt;  $ var_time     : num  1461 1461 1461 1461</span></span>
<span><span class="co">#&gt;  $ var_indicator: num  0 0 0 0</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### Extract test data using extract_test_data</span></span>
<span><span class="va">test_data</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/extract_test_data.html">extract_test_data</a></span><span class="op">(</span><span class="va">pat</span>, </span>
<span>                               codelist.vector <span class="op">=</span> <span class="va">codelist</span>, </span>
<span>                               indexdt <span class="op">=</span> <span class="st">"fup_start"</span>, </span>
<span>                               db.open <span class="op">=</span> <span class="va">aurum_extract</span>,</span>
<span>                               time.prev <span class="op">=</span> <span class="cn">Inf</span>,</span>
<span>                               return.output <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">)</span></span>
<span><span class="co">#&gt; 'data.frame':    4 obs. of  2 variables:</span></span>
<span><span class="co">#&gt;  $ patid: chr  "1" "3" "4" "6"</span></span>
<span><span class="co">#&gt;  $ value: num  84 NA NA 28</span></span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co">### Disconnect</span></span>
<span><span class="fu">RSQLite</span><span class="fu">::</span><span class="fu">dbDisconnect</span><span class="op">(</span><span class="va">aurum_extract</span><span class="op">)</span></span></code></pre></div>
<p>Once all the variables of interest have been extracted, they can be
merged into an analysis-ready dataset.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">### Recursive merge</span></span>
<span><span class="va">analysis.ready.pat</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/funprog.html" class="external-link">Reduce</a></span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">df1</span>, <span class="va">df2</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/merge.html" class="external-link">merge</a></span><span class="op">(</span><span class="va">df1</span>, <span class="va">df2</span>, by <span class="op">=</span> <span class="st">"patid"</span>, all.x <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">pat</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"patid"</span>, <span class="st">"gender"</span>, <span class="st">"yob"</span><span class="op">)</span><span class="op">]</span>, <span class="va">ho</span>, <span class="va">time_until</span>, <span class="va">test_data</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="va">analysis.ready.pat</span></span>
<span><span class="co">#&gt;   patid gender  yob ho var_time var_indicator value</span></span>
<span><span class="co">#&gt; 1     1      2 1984  1     1461             0    84</span></span>
<span><span class="co">#&gt; 2     3      1 1930  0     1461             0    NA</span></span>
<span><span class="co">#&gt; 3     4      2 1915  0     1461             0    NA</span></span>
<span><span class="co">#&gt; 4     6      1 1914  1     1461             0    28</span></span></code></pre></div>
<p>Note that all the functions for extracting variables also have an
option <code>out.save.disk</code> for saving the extracted data directly
onto the hard disk. The filepath where to save can be specified manually
through the <code>out.filepath</code> argument. However, is this
argument is left as <code>NULL</code>, while
<code>out.disk.save = TRUE</code>, rAURUM will automatically try to save
the extracted variable into a directory “data/extraction/”. The name of
the file itself will be dependent on the variable name specified through
argument <code>varname</code>. This can be a very convenient way to save
the output directly to disk without having to repeatdly specify
filepaths and filenames.</p>
<p>There is similar functionality when specifying the code lists.
Codelists can be specified in two ways. The first is to read the
codelist into R as a character vector and then specify through the
argument <code>codelist.vector</code>. Codelists stored on the hard disk
can also be referred to from the <code>codelist</code> argument, but
require a specific underlying directory structure. The codelist on the
hard disk must be stored in a directory called “codelists/analysis/”
relative to the working directory. The codelist must be a .csv file, and
contain a column “medcodeid”, “prodcodeid” or “ICD10” depending on the
input for argument <code>tab</code>. The input to argument
<code>codelist</code> should just be a character string of the name of
the files (excluding the suffix ‘.csv’). The
<code>codelist.vector</code> option will take precedence over the
<code>codelist</code> argument if both are specified.</p>
<p>Finally, there is similar functionality for accessing the SQLite
databases from within these functions, rather than having to open a
connection, use this as an input in the function, and then remember to
close the connection. Instead, if the SQLite database is stored in a
directory “data/sql/” relative to the working directory, the SQLite
database can be referred to by name (a character string) in the argument
<code>db</code>. Alternatively, a SQLite database stored anywhere on the
hard disk can be accessed by specifying the full filepath (character
string) in the argument <code>db.filepath</code>. A connection to the
SQLite datbase will be opened, the SQLite database will be queried, and
then the connection closed.</p>
<p><strong>I will be writing up more documentation on the appropriate
directory structures to use these functions most efficiently. It is
tricky to elicit this functionality in this vignette given the required
directory structures. Something I am thinking about.</strong></p>
</div>
<div class="section level2">
<h2 id="functions-for-specific-variables">Functions for specific variables<a class="anchor" aria-label="anchor" href="#functions-for-specific-variables"></a>
</h2>
<p>Finally, a number of functions have been written for extracting
specified variables, which do not fit into the above categories.
See:</p>
<ul>
<li>
<code>extract_age</code>: Derives age relative to an index date.
Assumes individual born on 1st July.</li>
<li>
<code>extract_bmi</code>: Derives BMI scores. Requires specification
of codelist for BMI, height, and weight separately.</li>
<li>
<code>extract_cholhdl_ratio</code>: Derives total
cholesterol/high-density lipoprotein ratio. Requires specification of
separate codelists for total cholesterol/high-density lipoprotein ratio,
total cholesterol, and high-density lipoproteins separately.</li>
<li>
<code>extract_diabetes</code>: Derives a categorical variable for
history of type 1 diabetes, history of type 2 diabetes or no history of
diabetes. Requires specification of separate codelists for type 1 and
type 2 diabetes.</li>
<li>
<code>extract_ethnicity</code>: Derives a categorical variable for
ethnicity, categories bangladeshi, black african, black caribbean,
chinese, indian, other asian, other ethnic group, pakistani or white (a
separate code list is required for each).</li>
<li>
<code>extract_smoking</code>: Derives a categorical variable for
smoking status. Requires specification of seperate codelists for
non-smoker, ex-smoker, light smoker, moderate smoker and heavy smoker.
If the most recent smoking status is non-smoker, but there are
historical codes which indicate smoking, then individual will be
classified as an ex-smoker.</li>
<li>
<code>extract_test_data_var</code>: Derives standard deviation of
test data values recorded over a specified time period.</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by First Last.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.9.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
